<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Vortex Owner Dashboard</title>
  <link rel="stylesheet" href="owner-dashboard.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
</head>
<body>
  <header class="header">
    <div class="header-content">
      <div class="logo-container">
        <img src="https://i.postimg.cc/ZRQYcx0d/Fitness-Club-1-removebg-preview.png" alt="Vortex Logo" class="logo-image" />
        <h1>Owner Dashboard</h1>
      </div>
      <nav class="header-actions">
        <a class="pill-link" href="../cafe/index.html">Staff Portal</a>
        <a class="pill-link" href="../Suppliment/index.html">Supplements Site</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <!-- Filters -->
    <section class="filters-card">
      <div class="filters-left">
        <button class="filter-btn" data-range="today">Today</button>
        <button class="filter-btn" data-range="7d">Last 7 days</button>
        <button class="filter-btn" data-range="30d">Last 30 days</button>
        <button class="filter-btn" data-range="custom">Custom</button>
        <input id="date-range-picker" class="date-input" placeholder="Select date range" />
      </div>
      <div class="filters-right">
        <button id="export-cafe" class="btn-secondary">Export Café CSV</button>
        <button id="export-supp" class="btn-secondary">Export Supplements CSV</button>
      </div>
    </section>

    <!-- Top Summary -->
    <section class="summary-grid">
      <div class="summary-card">
        <div class="summary-icon bg-cyan"><i data-lucide="banknote"></i></div>
        <div>
          <p class="summary-label">Total Revenue</p>
          <p id="total-revenue" class="summary-value">৳0.00</p>
        </div>
      </div>
      <div class="summary-card">
        <div class="summary-icon bg-green"><i data-lucide="check-circle-2"></i></div>
        <div>
          <p class="summary-label">Completed Orders</p>
          <p id="total-orders" class="summary-value">0</p>
        </div>
      </div>
      <div class="summary-card">
        <div class="summary-icon bg-amber"><i data-lucide="chart-line"></i></div>
        <div>
          <p class="summary-label">Supplements Profit*</p>
          <p id="net-profit" class="summary-value">৳0.00</p>
          <p class="muted">*Selling − Buying (supplements only) − expenses</p>
        </div>
      </div>
      <div class="summary-card">
        <div class="summary-icon bg-red"><i data-lucide="triangle-alert"></i></div>
        <div>
          <p class="summary-label">Low Stock (Supp.)</p>
          <p id="low-stock-count" class="summary-value">0</p>
        </div>
      </div>
    </section>

    <div id="loading" class="loading visible">
      <div class="spinner"></div>
      <p>Loading analytics…</p>
    </div>

    <section id="analytics-content" class="hidden">
      <!-- Split Transactions -->
      <div class="split-grid">
        <div class="card">
          <div class="card-header">
            <h2><i data-lucide="coffee" class="mr-8"></i> Café Menu Sales</h2>
          </div>
          <div id="cafe-transactions" class="list-col"></div>
        </div>
        <div class="card">
          <div class="card-header">
            <h2><i data-lucide="pill" class="mr-8"></i> Supplements Sales</h2>
          </div>
          <div id="supp-transactions" class="list-col"></div>
        </div>
      </div>

      <!-- Supplements Insights -->
      <div class="split-grid">
        <div class="card">
          <div class="card-header">
            <h2><i data-lucide="trophy" class="mr-8"></i> Top Supplements (Revenue)</h2>
          </div>
          <ul id="top-supp-by-revenue" class="simple-list"></ul>
        </div>
        <div class="card">
          <div class="card-header">
            <h2><i data-lucide="package" class="mr-8"></i> Top Supplements (Units)</h2>
          </div>
          <ul id="top-supp-by-units" class="simple-list"></ul>
        </div>
      </div>

      <!-- Inventory + Expenses -->
      <div class="split-grid">
        <div class="card">
          <div class="card-header">
            <h2><i data-lucide="boxes" class="mr-8"></i> Low Stock Supplements</h2>
          </div>
          <ul id="low-stock-list" class="simple-list"></ul>
        </div>
        <div class="card">
          <div class="card-header">
            <h2><i data-lucide="wallet" class="mr-8"></i> Expenses (Period)</h2>
          </div>
          <form id="expense-form" class="expense-form">
            <input id="exp-description" placeholder="Description" required />
            <input id="exp-amount" type="number" step="0.01" placeholder="Amount" required />
            <input id="exp-category" placeholder="Category (optional)" />
            <button class="btn-primary" type="submit">Add Expense</button>
          </form>
          <ul id="expense-list" class="simple-list mt-12"></ul>
        </div>
      </div>

      <p id="no-data-msg" class="empty-message hidden">No transactions found for the selected period.</p>
    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="owner-dashboard.js"></script>
</body>
</html>
